<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Sensibilisation au Phishing</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background-color: #f4f4f9;
            color: #333;
        }

        h1 {
            color: #0056b3;
            text-align: center;
        }

        .content {
            max-width: 600px;
            margin: auto;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="content">
        <h1>Sensibilisation au phishing</h1>
        <p>Cette page est destinée à éduquer les utilisateurs sur les dangers du phishing. Il est crucial d'être vigilant et de savoir reconnaître les tentatives de phishing pour protéger vos informations personnelles.</p>
    </div>

   <script>
function getOrCreateUserId() {
    if (!localStorage.getItem('userId')) {
        localStorage.setItem('userId', generateUUID());
    }
    return localStorage.getItem('userId');
}

function generateUUID() { // Fonction simple pour générer un UUID
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
    });
}

document.addEventListener('DOMContentLoaded', function() {
    var userID = getOrCreateUserId(); // Récupère ou crée un UUID unique pour l'utilisateur

    // Envoi des informations au chargement de la page
    fetch('https://script.google.com/macros/s/AKfycbxWHXc3uSELReSeHYwwL5Qg_rpalViHA0SHpAZNZ7RKDyQ7LWKUE2z7m2GQEiWe69W2/exec', {
        method: 'POST',
        mode: 'no-cors',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ userID: userID, url: window.location.href, action: 'Page Load' })
    }).catch(function(error) {
        console.error('Error:', error);
    });

    // Ajout des gestionnaires d'événements pour les liens
    var links = document.querySelectorAll('a.trackable');
    links.forEach(function(link) {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            var url = this.href;
            fetch('https://script.google.com/macros/s/AKfycbxWHXc3uSELReSeHYwwL5Qg_rpalViHA0SHpAZNZ7RKDyQ7LWKUE2z7m2GQEiWe69W2/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ userID: userID, url: url, action: 'Link Click' })
            }).then(function(response) {
                window.location.href = url;
            }).catch(function(error) {
                console.error('Error:', error);
            });
        });
    });
});
</script>

</body>
</html>
